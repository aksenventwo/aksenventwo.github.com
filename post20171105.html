<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Python下安装cx_Oracle问题一览</title>
<link rel="shortcut icon" href="favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<!-- Bootstrap css -->
<link type="text/css" rel='stylesheet' href="css/bootstrap.min.css">
<!-- End Bootstrap css -->
<!-- 马克飞象 -->
<link href='css/mark.css' rel='stylesheet'>
<!-- end马克飞象 -->
<link type="text/css" data-themecolor="default" rel='stylesheet' href="css/main-default.css">
</head>
<body>
<div class="mask-l" style="background-color: #fff; width: 100%; height: 100%; position: fixed; top: 0; left:0; z-index: 9999999;"></div>
<!-- 页面导航栏模块 -->
<header>
    <div class="container b-header__box b-relative">
        <div class="b-header-r b-right b-header-r--icon">
            <div class="b-top-nav-show-slide f-top-nav-show-slide b-right j-top-nav-show-slide">
                <i class="fa fa-align-justify"></i>
            </div>
            <nav class="b-top-nav f-top-nav b-right j-top-nav">
                <ul class="b-top-nav__1level_wrap">
                    <li class="b-top-nav__1level f-top-nav__1level is-active-top-nav__1level f-primary-b">
                        <a href="index.html"><i class="fa fa-home b-menu-1level-ico"></i>首页 
                            <span class="b-ico-dropdown"><i class="fa fa-arrow-circle-down"></i></span>
                        </a>  
                    </li>

                    <li class="b-top-nav__1level f-top-nav__1level f-primary-b">
                        <a href="#"><i class="fa fa-code b-menu-1level-ico"></i>博客文章列表
                            <span class="b-ico-dropdown"><i class="fa fa-arrow-circle-down"></i></span>
                        </a>
                    </li>

                    <li class="b-top-nav__1level f-top-nav__1level f-primary-b">
                        <a href="#"><i class="fa fa-folder-open b-menu-1level-ico"></i>联系我
                            <span class="b-ico-dropdown"><i class="fa fa-arrow-circle-down"></i></span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</header>
<!-- end页面导航栏模块 -->

<!-- <div class="j-menu-container"></div>
 -->
<!-- 页面标题模块 -->
<div class="b-inner-page-header f-inner-page-header">
  <div class="b-inner-page-header__content">
    <div class="container">
      <h1 class="f-primary-l c-default">Python下安装cx_Oracle问题一览</h1>
    </div>
  </div>
</div>
<!-- end页面标题模块 -->

<!-- 页面内容模块 -->
<div class="l-main-container">
    <div class="l-inner-page-container">
        <div class="container">
            <div class="row">
                <!-- 文章展示版块 -->
                <div class="col-md-9 col-md-push-3">
                    <!-- 文章1入口 -->
                    <div class="b-blog-listing__block">
                    <!-- 头部图片 -->
                    <div class="b-blog-listing__block-top">
                    </div>
                    <!-- end头部图片 -->
                    <div class="b-infoblock-with-icon b-blog-listing__infoblock">
                      <a href="#" class="b-infoblock-with-icon__icon f-infoblock-with-icon__icon fade-in-animate hidden-xs">
                          <i class="fa fa-pencil"></i>
                      </a>
                      <div class="b-infoblock-with-icon__info f-infoblock-with-icon__info">
                        <a href="#" class="f-infoblock-with-icon__info_title b-infoblock-with-icon__info_title f-primary-l b-title-b-hr f-title-b-hr">
                            Python下安装cx_Oracle问题一览
                        </a>
                        <div class="f-infoblock-with-icon__info_text b-infoblock-with-icon__info_text f-primary-b b-blog-listing__pretitle">
                              作者 <a href="#" class="f-more">Edpzou</a> 标签 <a href="#" class="f-more">Python第三方库</a>, <a href="#" class="f-more">写于</a> 2017-11-05
                        </div>
                        <div id='preview-contents' class='note-content'>                        
                        <h3 id="安装问题">安装问题</h3>

                        <p><code>pip install cx_Oracle</code></p>

                        <p>安装好包后，还需下载Oracle的客户端，必须要登录才能下载</p>

                        <p><a href="https://oracle.github.io/odpi/doc/installation.html#oracle-client-and-database-versions" target="_blank">原文在这</a></p>

                        <p>根据提示安装好Oracle的客户端后，环境变量的设置很重要，这里举例说明：</p>

                        <ul><li>安装Oracle客户</li>
                        </ul>

                        <pre class="prettyprint hljs-dark"><code class="hljs lsl"><div class="hljs-line">mkdir -p /opt/oracle
                        </div><div class="hljs-line">cd /opt/oracle
                        </div><div class="hljs-line">unzip instantclient-basic-linux.x64<span class="hljs-number">-12.2</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-number">.0</span>.zip
                        </div></code></pre>

                        <ul><li>安装libaio包</li>
                        </ul>

                        <pre class="prettyprint hljs-dark"><code class="hljs cmake"><div class="hljs-line">sudo yum <span class="hljs-keyword">install</span> libaio
                        </div></code></pre>

                        <ul><li>设置Oracle客户端的环境变量，它的路径和你下载的包的路径有关，一定要关联起来</li>
                        </ul>

                        <pre class="prettyprint hljs-dark"><code class="hljs bash"><div class="hljs-line"><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=/opt/oracle/instantclient_12_2:<span class="hljs-variable">$LD_LIBRARY_PATH</span>
                        </div></code></pre>

                        <ul><li>Virtualenv环境下使用cx_Oracle常见问题之一是找不到Oracle客户端的环境变量，原因之一就是因为你的虚拟环境文件夹在 <br>
                        上面的步骤执行之前生成的，导致它启动虚拟环境的脚本activae没有写入这个环境变量，修改即可。</li>
                        </ul>

                        <pre class="prettyprint hljs-dark"><code class="hljs awk"><div class="hljs-line">vim <span class="hljs-regexp">/xxx/</span>venv<span class="hljs-regexp">/Scripts/</span>activate
                        </div></code></pre>

                        <p>添加 <br>
                            export LD_LIBRARY_PATH=/opt/oracle/instantclient_12_2</p>

                        <p>它就可以在虚拟环境下使用了。</p>



                        <h3 id="中文乱码问题">中文乱码问题</h3>

                        <p>在对Oracle数据操作时，必须要解决的就是字符集的问题，这里有三个主要地方，数据库的字符集设置，程序运行环境的字符集，和需要插入数据的的字符集。</p>

                        <p><em>三者统一，则显示正常</em> </p>

                        <p>还有就是可以不管数据库字符集是什么，程序运行环境的字符集和插入数据的字符集一致也可以显示正常。</p>



                        <h3 id="python如何设置运行环境字符集">python如何设置运行环境字符集?</h3>

                        <p>python设置环境变量可以使用:</p>



                        <pre class="prettyprint hljs-dark"><code class="hljs moonscript"><div class="hljs-line"><span class="hljs-keyword">import</span> <span class="hljs-built_in">os</span>
                        </div><div class="hljs-line">
                        </div><div class="hljs-line"><span class="hljs-built_in">os</span>.environ[<span class="hljs-string">'NLS_LANG'</span>] = <span class="hljs-string">'SIMPLIFIED CHINESE_CHINA.AL32UTF8'</span>
                        </div><div class="hljs-line">
                        </div></code></pre>

                        <p>这两行代码的位置很重要，如果你的python脚本只是一个单文件，那么就放在该脚本里，如果你的python代码不只是一个文件，它是一个大型程序，那么这两行代码必须放在运行脚本里，也就是有<code>if __name__ == '__main__:'</code>的文件里。</p>

                        <p>原因是， 这种设置的环境变量是临时的，只针对当前进程有效，并且当前进程下是有的子进程、线程都是有效。所以要设置环境变量必须设置的父进程的开始处。</p>



                        <h3 id="python如何处理编码问题">python如何处理编码问题?</h3>

                        <p>字符串在Python内部的表示是unicode编码，因此，在做编码转换时，通常需要以unicode作为中间编码，即先将其他编码的字符串解码（decode）成unicode，再从unicode编码（encode）成另一种编码。  <br>
                        decode的作用是将其他编码的字符串转换成unicode编码，如str1.decode(‘gb2312’)，表示将gb2312编码的字符串str1转换成unicode编码。 </p>

                        <p>encode的作用是将unicode编码转换成其他编码的字符串，如str2.encode(‘gb2312’)，表示将unicode编码的字符串str2转换成gb2312编码。 </p>

                        <p>因此，转码的时候一定要先搞明白，字符串str是什么编码，然后decode成unicode，然后再encode成其他编码</p>
                    </div>
                    </div>
                </div>      
                </div>
                <!-- end文章1入口 -->
                </div>
                <!-- end文章展示版块 -->

                <div class="visible-xs-block visible-sm-block b-hr"></div>

                <!-- 左侧栏归纳模块 -->
                <div class="col-md-3 col-md-pull-9">
                    <div class="row b-col-default-indent">
                        <!-- 文章分类板块 -->
                        <div class="col-md-12">
                            <div class="b-categories-filter">
                                <h4 class="f-primary-b b-h4-special f-h4-special--gray f-h4-special">博客系列</h4>
                                <ul>
                                    <li>
                                        <a class="f-categories-filter_name" href="#"><i class="fa fa-plus"></i> Python第三方库</a>
                                        <span class="b-categories-filter_count f-categories-filter_count" id="python_3">1</span>
                                    </li>
                                    <li>
                                        <a class="f-categories-filter_name" href="#"><i class="fa fa-plus"></i> 日常问题</a>
                                        <span class="b-categories-filter_count f-categories-filter_count" id="normal_qa">1</span>
                                    </li>
                                    <li>
                                        <a class="f-categories-filter_name" href="#"><i class="fa fa-plus"></i> Python系统</a>
                                        <span class="b-categories-filter_count f-categories-filter_count" id="python">1</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- end文章分类板块 -->
                        <!-- 最新文章板块 -->
                        <div class="col-md-12">
                            <h4 class="f-primary-b b-h4-special  f-h4-special--gray f-h4-special">最新文章</h4>
                            <div class="b-blog-short-post b-blog-short-post--img-hover-bordered b-blog-short-post--w-img f-blog-short-post--w-img row">
                                <div class="b-blog-short-post b-blog-short-post--img-hover-bordered b-blog-short-post--w-img f-blog-short-post--w-img row" id="recently_post">
                                </div>
                            </div>
                        </div>
                        <!-- end最新文章板块 -->
                        <!-- 标签词云模块 -->
                        <div class="col-md-12">
                            <h4 class="f-primary-b b-h4-special f-h4-special--gray f-h4-special">标签 词云</h4>
                            <div id="word_cloud"></div>
                        </div>
                        <!-- end标签词云模块 -->
                    </div> 
                </div>
                <!-- end左侧栏归纳模块 -->
            </div>
        </div>
    </div>
</div>
<!-- 页面底部模块 -->
<footer>
    <div class="container">
        <div class="b-footer-secondary row">
            <div class="col-md-4 col-sm-12 col-xs-12 f-center b-footer-logo-containter">
                <div class="b-footer-logo-text f-footer-logo-text">
                    <p>我</p>
                    <div class="b-btn-group-hor f-btn-group-hor">
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-twitter">E</i></a>
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-facebook">D</i></a>
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-dribbble">P</i></a>
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-behance">Z</i></a>
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-behance">O</i></a>
                        <a href="#" class="b-btn-group-hor__item f-btn-group-hor__item"><i class="fa fa-behance">U</i></a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-sm-12 col-xs-12">
                <h4 class="f-primary-b">常逛网站</h4>
                    <div class="b-blog-short-post row">
                    <div class="b-blog-short-post__item col-md-12 col-sm-4 col-xs-12 f-primary-b">
                        <div class="b-blog-short-post__item_text f-blog-short-post__item_text">
                            <a href="https://github.com">github</a>
                        </div>
                    </div>
                    <div class="b-blog-short-post__item col-md-12 col-sm-4 col-xs-12 f-primary-b">
                        <div class="b-blog-short-post__item_text f-blog-short-post__item_text">
                            <a href="https://segmentfault.com/">segmentfault</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 col-sm-12 col-xs-12">
                <h4 class="f-primary-b">联系我</h4>
                <div class="b-contacts-short-item-group">
                    <div class="b-contacts-short-item col-md-12 col-sm-4 col-xs-12">
                        <div class="b-contacts-short-item__icon f-contacts-short-item__icon b-left f-contacts-short-item__icon_xs">
                            <i class="fa fa-envelope"></i>
                        </div>
                        <div class="b-remaining f-contacts-short-item__text f-contacts-short-item__text_email">
                            <a href="mailto:frexystudio@gmail.com">xiaoshengzou@163.com</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- end页面底部模块 -->

<!-- js模块 -->
<script src="js/jquery/jquery-1.11.1.min.js"></script>
<!-- bootstrap -->
<script src="js/bootstrap.min.js"></script>
<!-- end bootstrap -->
<!-- Modules -->
<script src="js/modules/color-themes.js"></script>
<!-- End Modules -->
<script src="js/cookie.js"></script>
<!-- endjs模块 -->
<!-- config -->
<script src="js/config.js"></script>
<!-- endconfig -->
</body>
</html>